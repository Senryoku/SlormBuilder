const sha1 = require("js-sha1");

function strToHex(str) {
	let base = "";
	for (let i = 0; i < str.length; ++i) {
		base += str.charCodeAt(i).toString(16).toUpperCase();
	}
	return base;
}

function hexToStr(base) {
	let str = "";
	let idx = 0;
	while (idx < base.length - 1) {
		let hex = base[idx] + base[idx + 1];
		str += String.fromCharCode(parseInt(hex, 16));
		idx += 2;
	}
	return str;
}

function hexToArray(base) {
	let arr = [];
	let idx = 0;
	while (idx < base.length - 1) {
		let hex = base[idx] + base[idx + 1];
		arr.push(parseInt(hex, 16));
		idx += 2;
	}
	return arr;
}

function computeHash(base) {
	let str = [...base].map((i) => i.charCodeAt(0));

	const key = "07HopeThisOneNeverGetsOutIfYouFindItOutContactUs14";

	let buf_key = new Uint8Array(64); //buffer_create(64, buffer_fixed, 1)
	let buf_innerPad = new Uint8Array(64 + str.length); //buffer_create((64 + string_length(str)), buffer_fixed, 1)
	let buf_outerPad = new Uint8Array(84); //buffer_create(84, buffer_fixed, 1)
	if (key.length > 64) {
		buf_key.set(sha1.array(key));
	} else {
		buf_key.set([...key].map((i) => i.charCodeAt(0)));
	}

	for (let n = 0; n < 64; ++n) {
		let keyVal = buf_key[n]; //buffer_peek(buf_key, n, buffer_u8)
		buf_innerPad.set([54 ^ keyVal], n); //buffer_poke(buf_innerPad, n, buffer_u8, (54 ^ keyVal))
		buf_outerPad.set([92 ^ keyVal], n); //buffer_poke(buf_outerPad, n, buffer_u8, (92 ^ keyVal))
	}

	//Append the message to the inner buffer
	buf_innerPad.set(str, 64);

	//Append the hash of the inner buffer to the outer buffer
	buf_outerPad.set(sha1.array(buf_innerPad), 64);

	return sha1(buf_outerPad); //hash.hex();
}

function encodeSave(str) {
	const b = strToHex(str);
	return b + "#" + computeHash(b) + "#";
}

function extractSaveStr(save) {
	return hexToStr(save.split("#")[0]);
}

const save_input = document.getElementById("save-input");
const save_edit = document.getElementById("save-edit");
const save_output = document.getElementById("save-ouput");

save_input.addEventListener("input", function () {
	console.log("save_input input");
	console.log(
		"Test: ",
		save_input.value === encodeSave(extractSaveStr(save_input.value))
	);
	save_edit.value = extractSaveStr(save_input.value);
	save_output.value = encodeSave(save_edit.value);
});

save_edit.addEventListener("input", function () {
	console.log("save_edit input");
	save_output.value = encodeSave(save_edit.value);
});

const testValue =
	"920100001F000000010000000A00000071756573745F6C69737400000000000000000000F0BF010000000C000000776561706F6E5F65717569700100000005000000307C307C30010000000D00000073746174735F666574636865640100000021020000302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C30010000000700000076657273696F6E0100000009000000302E312E3039373334010000000D000000736C6F726D6974655F6C69737400000000000000000000F0BF01000000100000007368617265645F696E76656E746F72790100000069010000303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B30010000000A00000066697273745F6865726F000000000000000000000000010000000B000000776561706F6E5F64617461010000007F160000303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A307C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A307C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A302C303A303A303A302F303A303A303A30010000000800000067616D656D6F64650100000005000000307C307C30010000000B000000736B696C6C5F657175697001000000D00700002D312C2D312C2D312C322C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D317C2D312C2D312C2D312C322C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D317C2D312C2D312C2D312C322C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D312C2D3101000000040000006865726F00000000000000000000000001000000080000006D697373696F6E73010000005F000000302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C30010000001200000073746F72655F726566726573685F6C6973740000000000000000000000000100000006000000747261697473010000002F000000312C302C302C302C302C302C302C307C302C302C302C302C302C302C312C307C302C302C302C302C302C312C302C30010000000A00000072657075746174696F6E000000000000000000000000010000000500000077726174680100000005000000317C317C31010000000A000000736B696C6C5F72616E6B0100000037050000302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C30010000000B0000007265617065725F70697479010000000B0000003135307C3135307C3135300100000004000000676F6C64000000000000000000000000010000000200000078700100000005000000307C307C300100000009000000696E76656E746F727901000000C1010000303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B307C303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B307C303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B303B300100000005000000736C6F726D0100000005000000307C307C300100000009000000696E666C75656E63650100000009000000307C307C307C307C30010000000D000000656C656D656E745F65717569700100000017060000302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C3001000000090000007475746F7269616C73010000009B000000307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C307C30010000000E00000065717569706D656E745F6C69737401000000D3000000312E312E312E302E312E302D302E302E312E382E303A4E2E31392E37312E303A4E2E31352E37302E307C312E312E312E302E312E302D302E312E312E31342E303A4E2E33312E39382E303A4E2E31372E37312E307C312E352E312E302E312E302D302E322E312E372E303A4E2E33312E38362E303A4E2E34302E38342E303B312E312E312E302E312E302D302E322E312E31312E303A4E2E302E37322E303A4E2E31332E38382E303B312E352E312E302E312E302D302E322E312E31372E303A4E2E31372E38352E303A4E2E33302E32302E30010000000C000000656C656D656E745F72616E6B0100000083030000302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C30010000000B000000656E656D795F6D617463680100000005000000317C317C310100000005000000617572617301000000230000002D312C2D312C2D312C2D317C2D312C2D312C2D312C2D317C2D312C2D312C2D312C2D31010000000700000070726F66696C6501000000D9040000382C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C307C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C302C30010000000B000000656E656D795F6C6576656C0100000005000000317C317C31#0b5b5c7052fc23bb9c70749ecc2d613758a4d0e1#";

const testStr = testValue.split("#")[0];
const hash = testValue.split("#")[1];
console.log(
	"Original Hash: ",
	hash,
	" | Computed: ",
	computeHash(testStr),
	" | Test?: ",
	hash === computeHash(testStr)
);
console.log("Test ===: ", testValue === encodeSave(extractSaveStr(testValue)));
console.log(
	"Test localeCompare: ",
	testValue.localeCompare(encodeSave(extractSaveStr(testValue)))
);

console.log("Test hex/str conv: ", strToHex(hexToStr(testStr)) == testStr);
